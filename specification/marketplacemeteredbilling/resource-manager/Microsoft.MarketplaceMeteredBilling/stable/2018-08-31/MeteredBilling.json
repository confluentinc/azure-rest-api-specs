{
  "swagger": "2.0",
  "info": {
    "title": "MarketplaceMeteredBilling",
    "description": "REST API for MarketplaceMeteredBilling.",
    "version": "2018-08-31"
  },
  "host": "marketplaceapi.microsoft.com",
  "basePath": "/api",
  "schemes": [
    "https"
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "security": [
    {
      "azure_auth": [
        "user_impersonation"
      ]
    }
  ],
  "securityDefinitions": {
    "azure_auth": {
      "type": "oauth2",
      "authorizationUrl": "https://login.microsoftonline.com/common/oauth2/authorize",
      "flow": "implicit",
      "description": "Azure Active Directory OAuth2 Flow",
      "scopes": {
        "user_impersonation": "impersonate your user account"
      }
    }
  },
  "paths": {
    "/usageEvent": {
      "post": {
        "description": "Report single usage event.",
        "operationId": "MarketplaceMeteredBilling_UsageEvent",
        "parameters": [
          {
            "$ref": "#/parameters/ApiVersionParameter"
          },
          {
            "name": "authorization",
            "in": "header",
            "required": true,
            "type": "string",
            "description": "Bearer token for authorization."
          },
          {
            "name": "x-ms-requestid",
            "in": "header",
            "required": false,
            "type": "string",
            "description": "A unique string value for tracking the request from the client, preferably a GUID. If this value isn't provided, one will be generated and provided in the response headers."
          },
          {
            "name": "x-ms-correlationid",
            "in": "header",
            "required": false,
            "type": "string",
            "description": "A unique string value for operation on the client. This parameter correlates all events from client operation with events on the server side. If this value isn't provided, one will be generated and provided in the response headers."
          },
          {
            "name": "parameters",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/UsageEvent"
            },
            "description": "Parameters supplied to report a single usage event."
          }
        ],
        "x-ms-examples": {
          "UsageEvent": {
            "$ref": "./examples/UsageEvent.json"
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          },
          "400": {
            "description": "Bad request, missing or invalid data provided or expired"
          },
          "403": {
            "description": "Bad request, missing or invalid data provided or expired"
          },
          "409": {
            "description": "Conflict, when we receive the usage call for the usage resource ID, and effective usage, which already exists. The response will contain additionalInfo field that contains info about the accepted message."
        }
        }
      }
    },
    "/batchUsageEvent": {
      "post": {
        "description": "Report batch usage events.",
        "operationId": "MarketplaceMeteredBilling_BatchUsageEvent",
        "parameters": [
          {
            "$ref": "#/parameters/ApiVersionParameter"
          },
          {
            "name": "authorization",
            "in": "header",
            "required": true,
            "type": "string",
            "description": "Bearer token for authorization."
          },
          {
            "name": "parameters",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/BatchUsageEvent"
            },
            "description": "Parameters supplied to report batch usage events."
          }
        ],
        "x-ms-examples": {
          "UsageEvent": {
            "$ref": "./examples/BatchUsageEvent.json"
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          },
          "400": {
            "description": "Bad request, missing or invalid data provided or expired"
          },
          "403": {
            "description": "Bad request, missing or invalid data provided or expired"
          }
        }
      }
    }
  },
  "parameters": {
    "ApiVersionParameter": {
      "name": "api-version",
      "in": "query",
      "required": true,
      "type": "string",
      "description": "The API version to use for the request."
    }
  },
  "definitions": {
    "UsageEvent": {
      "allOf": [
        {
          "$ref": "#/definitions/UsageEventProperties"
        }
      ],
      "description": "The UsageEvent endpoint allows you to emit usage events for a specific purchased entity"
    },
    "UsageEventProperties": {
      "properties": {
        "resourceId": {
          "type": "string",
          "description": "Identifier of the resource against which usage is emitted."
        },
        "quantity": {
          "type": "number",
          "description": "Quantity of the dimension being reported."
        },
        "dimension": {
          "type": "string",
          "description": "Dimension identifier."
        },
        "effectiveStartTime": {
          "type": "string",
          "description": "Time in UTC when the usage event occurred."
        },
        "planId": {
          "type": "string",
          "description": "Plan associated with the purchased offer."
        }
      },
      "description": "UsageEvent definition"
    },

    "BatchUsageEvent": {
      "allOf": [
        {
          "$ref": "#/definitions/BatchUsageEventProperties"
        }
      ],
      "description": "The batchUsageEvent endpoint allows you to emit usage events for a specific purchased entity"
    },
    "BatchUsageEventProperties": {
      "properties": {
        "request": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/UsageEventProperties"
          }
        }
      },
      "description": "BatchUsageEvent definition"
    }
  }
}
